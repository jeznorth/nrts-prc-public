<div class="applications-view" [ngClass]="isSidePanelVisible ? 'side-panel__open':'side-panel__closed'">
  <h1 class="sr-only">Find Applications in British Columbia</h1>

  <div class="side-nav">
    <ul>
      <li class="side-nav-item"
        [ngClass]="{'active': isSidePanelVisible && isFindAppsVisible}">
        <button class="btn" (click)="toggleFind()">
          <i class="material-icons">search</i>
          <div>Find</div>
        </button>
      </li>
      <li class="side-nav-item"
        [ngClass]="{'active': isSidePanelVisible && isExploreAppsVisible}">
        <button class="btn" (click)="toggleExplore()">
          <i class="material-icons">visibility</i>
          <div>Explore</div>
        </button>
      </li>
      <li class="side-nav-item"
        [ngClass]="{'active': isSidePanelVisible && isAppDetailsVisible}">
        <button class="btn" (click)="toggleDetails()">
          <i class="material-icons">info</i>
          <div>Details</div>
        </button>
      </li>
    </ul>
  </div>

  <div class="side-panel">
    <button class="close-btn btn btn-icon" (click)="closeSidePanel()">
      <i class="material-icons">close</i>
    </button>
    <app-details #appdetail
      [isLoading]="isLoading"
      (setCurrentApp)="updateDetails($event, true)"
      (unsetCurrentApp)="updateDetails($event, false)"
      [hidden]="!isAppDetailsVisible">
    </app-details>
    <app-applist-filters #appfilters
      [isLoading]="isLoading"
      (updateFilters)="updateFindFilters($event)"
      (showSidePanel)="isSidePanelVisible=$event"
      [hidden]="!isFindAppsVisible">
    </app-applist-filters>
    <app-explore #appexplore
      [isLoading]="isLoading"
      [appmap]="appmap"
      (updateFilters)="updateExploreFilters($event)"
      (showSidePanel)="isSidePanelVisible=$event"
      [hidden]="!isExploreAppsVisible">
    </app-explore>
  </div>

  <div class="main-panel">
    <div class="app-results">
      <span class="app-results__count"><strong>{{totalNumber}}</strong> applications found</span>
      <span class="app-results__clear" *ngIf="appfilters.filterCount() > 0 || appexplore.filterCount() > 0">
        <button class="clear-btn btn btn-sm btn-link" (click)="resetFilters()">Clear Filters</button>
      </span>
    </div>
    <app-applist-list class="app-list" style="display: none;" #applist
      [isLoading]="isLoading"
      [applications]="apps"
      [isListVisible]="isApplicationsListVisible"
      (setCurrentApp)="appmap.onHighlightApplication($event, true)"
      (unsetCurrentApp)="appmap.onHighlightApplication($event, false)">
    </app-applist-list>
    <app-applist-map class="app-map" #appmap
      [isLoading]="isLoading"
      [applications]="apps"
      [isMapVisible]="isApplicationsMapVisible"
      (toggleCurrentApp)="applist.toggleCurrentApp($event)"
      (updateCoordinates)="updateCoordinates($event)">
    </app-applist-map>
  </div>

</div>